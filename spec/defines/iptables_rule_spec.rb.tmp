require 'spec_helper'

describe 'iptables::rule' do
  let(:facts) { { :concat_basedir => '/var/lib/puppet/concat' } }

  context '=> allow ssh from ipv4 only' do
    let(:title) { 'allow ssh global' }
    let(:params) {
      { 'version' => 'ipv4',
        'source_port' => '22',
        'protocol' => 'tcp' } }

    it {
      should contain_iptables__ipv4__rule('allow ssh global') \
        .with( { 'options' => { 
                    'source_port' => '22',
                    'protocol' => 'tcp' } } )
    }
  end
end
